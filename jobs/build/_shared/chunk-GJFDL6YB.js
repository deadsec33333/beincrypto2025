import{D as J,Ga as x,Ia as O,Ja as X,K as U,Ka as F,La as $,Na as b,P as E,Pa as K,Q as z,b as m,c as H,ca as q,da as N,e as S,ea as G,f as g,fa as Q,g as I,j as W,k as w,oa as V,x as Z}from"/jobs/build/_shared/chunk-FJW73GJ6.js";import{k as s}from"/jobs/build/_shared/chunk-OTKXJQRY.js";s();s();function D(e){if(e.length!==66||e.indexOf("[")!==0||e.indexOf("]")!==65)return null;let r=`0x${e.slice(1,65)}`;return H(r)?r:null}function R(e){let r=new Uint8Array(32).fill(0);if(!e)return I(r);let t=e.split(".");for(let n=t.length-1;n>=0;n-=1){let a=D(t[n]),o=a?W(a):U(w(t[n]),"bytes");r=U(Z([r,o]),"bytes")}return I(r)}s();function Y(e){let r=new Uint8Array(32).fill(0);return e?D(e)||U(w(e)):I(r)}s();s();function C(e,r){if(!(e instanceof m))return!1;let t=e.walk(n=>n instanceof N);return t instanceof N?!!(t.data?.errorName==="ResolverNotFound"||t.data?.errorName==="ResolverWildcardNotSupported"||t.reason?.includes("Wildcard on non-extended resolvers is not supported")||r==="reverse"&&t.reason===z[50]):!1}s();s();function ee(e){return`[${e.slice(2)}]`}function y(e){let r=e.replace(/^\.|\.$/gm,"");if(r.length===0)return new Uint8Array(1);let t=new Uint8Array(w(r).byteLength+2),n=0,a=r.split(".");for(let o=0;o<a.length;o++){let i=w(a[o]);i.byteLength>255&&(i=w(ee(Y(a[o])))),t[n]=i.length,t.set(i,n+1),n+=i.length+1}return t.byteLength!==n+1?t.slice(0,n+1):t}s();function d(e,r,t){return n=>e[r.name||t]?.(n)??r(e,n)}s();s();var ce=3;function re(e,{abi:r,address:t,args:n,docsPath:a,functionName:o,sender:i}){let{code:c,data:u,message:l,shortMessage:h}=e instanceof Q?e:e instanceof m?e.walk(v=>"data"in v)||e.walk():{},k=(()=>e instanceof J?new G({functionName:o}):[ce,V.code].includes(c)&&(u||l||h)?new N({abi:r,data:typeof u=="object"?u.data:u,functionName:o,message:h??l}):e)();return new q(k,{abi:r,args:n,contractAddress:t,docsPath:a,functionName:o,sender:i})}async function p(e,{abi:r,address:t,args:n,functionName:a,...o}){let i=E({abi:r,args:n,functionName:a});try{let{data:c}=await d(e,K,"call")({data:i,to:t,...o});return x({abi:r,args:n,functionName:a,data:c||"0x"})}catch(c){throw re(c,{abi:r,address:t,args:n,docsPath:"/docs/contract/readContract",functionName:a})}}async function sr(e,{blockNumber:r,blockTag:t,coinType:n,name:a,universalResolverAddress:o}){let i=o;if(!i){if(!e.chain)throw new Error("client chain not configured. universalResolverAddress is required.");i=b({blockNumber:r,chain:e.chain,contract:"ensUniversalResolver"})}try{let c=E({abi:$,functionName:"addr",...n!=null?{args:[R(a),BigInt(n)]}:{args:[R(a)]}}),u=await d(e,p,"readContract")({address:i,abi:O,functionName:"resolve",args:[g(y(a)),c],blockNumber:r,blockTag:t});if(u[0]==="0x")return null;let l=x({abi:$,args:n!=null?[R(a),BigInt(n)]:void 0,functionName:"addr",data:u[0]});return l==="0x"||S(l)==="0x00"?null:l}catch(c){if(C(c,"resolve"))return null;throw c}}s();async function te(e,{blockNumber:r,blockTag:t,name:n,key:a,universalResolverAddress:o}){let i=o;if(!i){if(!e.chain)throw new Error("client chain not configured. universalResolverAddress is required.");i=b({blockNumber:r,chain:e.chain,contract:"ensUniversalResolver"})}try{let c=await d(e,p,"readContract")({address:i,abi:O,functionName:"resolve",args:[g(y(n)),E({abi:F,functionName:"text",args:[R(n),a]})],blockNumber:r,blockTag:t});if(c[0]==="0x")return null;let u=x({abi:F,functionName:"text",data:c[0]});return u===""?null:u}catch(c){if(C(c,"resolve"))return null;throw c}}s();s();s();s();var L=class extends m{constructor({data:r}){super("Unable to extract image from metadata. The metadata may be malformed or invalid.",{metaMessages:["- Metadata must be a JSON object with at least an `image`, `image_url` or `image_data` property.","",`Provided data: ${JSON.stringify(r)}`]});Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"EnsAvatarInvalidMetadataError"})}},A=class extends m{constructor({reason:r}){super(`ENS NFT avatar URI is invalid. ${r}`);Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"EnsAvatarInvalidNftUriError"})}},T=class extends m{constructor({uri:r}){super(`Unable to resolve ENS avatar URI "${r}". The URI may be malformed, invalid, or does not respond with a valid image.`);Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"EnsAvatarUriResolutionError"})}},_=class extends m{constructor({namespace:r}){super(`ENS NFT avatar namespace "${r}" is not supported. Must be "erc721" or "erc1155".`);Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"EnsAvatarUnsupportedNamespaceError"})}};var ue=/(?<protocol>https?:\/\/[^\/]*|ipfs:\/|ipns:\/|ar:\/)?(?<root>\/)?(?<subpath>ipfs\/|ipns\/)?(?<target>[\w\-.]+)(?<subtarget>\/.*)?/,fe=/^(Qm[1-9A-HJ-NP-Za-km-z]{44,}|b[A-Za-z2-7]{58,}|B[A-Z2-7]{58,}|z[1-9A-HJ-NP-Za-km-z]{48,}|F[0-9A-F]{50,})(\/(?<target>[\w\-.]+))?(?<subtarget>\/.*)?$/,de=/^data:([a-zA-Z\-/+]*);base64,([^"].*)/,le=/^data:([a-zA-Z\-/+]*)?(;[a-zA-Z0-9].*?)?(,)/;async function pe(e){try{let r=await fetch(e,{method:"HEAD"});return r.status===200?r.headers.get("content-type")?.startsWith("image/"):!1}catch(r){return typeof r=="object"&&typeof r.response<"u"||!globalThis.hasOwnProperty("Image")?!1:new Promise(t=>{let n=new Image;n.onload=()=>{t(!0)},n.onerror=()=>{t(!1)},n.src=e})}}function ne(e,r){return e?e.endsWith("/")?e.slice(0,-1):e:r}function P({uri:e,gatewayUrls:r}){let t=de.test(e);if(t)return{uri:e,isOnChain:!0,isEncoded:t};let n=ne(r?.ipfs,"https://ipfs.io"),a=ne(r?.arweave,"https://arweave.net"),o=e.match(ue),{protocol:i,subpath:c,target:u,subtarget:l=""}=o?.groups||{},h=i==="ipns:/"||c==="ipns/",k=i==="ipfs:/"||c==="ipfs/"||fe.test(e);if(e.startsWith("http")&&!h&&!k){let j=e;return r?.arweave&&(j=e.replace(/https:\/\/arweave.net/g,r?.arweave)),{uri:j,isOnChain:!1,isEncoded:!1}}if((h||k)&&u)return{uri:`${n}/${h?"ipns":"ipfs"}/${u}${l}`,isOnChain:!1,isEncoded:!1};if(i==="ar:/"&&u)return{uri:`${a}/${u}${l||""}`,isOnChain:!1,isEncoded:!1};let v=e.replace(le,"");if(v.startsWith("<svg")&&(v=`data:image/svg+xml;base64,${btoa(v)}`),v.startsWith("data:")||v.startsWith("{"))return{uri:v,isOnChain:!0,isEncoded:!1};throw new T({uri:e})}function M(e){if(typeof e!="object"||!("image"in e)&&!("image_url"in e)&&!("image_data"in e))throw new L({data:e});return e.image||e.image_url||e.image_data}async function oe({gatewayUrls:e,uri:r}){try{let t=await fetch(r).then(a=>a.json());return await B({gatewayUrls:e,uri:M(t)})}catch{throw new T({uri:r})}}async function B({gatewayUrls:e,uri:r}){let{uri:t,isOnChain:n}=P({uri:r,gatewayUrls:e});if(n||await pe(t))return t;throw new T({uri:r})}function ae(e){let r=e;r.startsWith("did:nft:")&&(r=r.replace("did:nft:","").replace(/_/g,"/"));let[t,n,a]=r.split("/"),[o,i]=t.split(":"),[c,u]=n.split(":");if(!o||o.toLowerCase()!=="eip155")throw new A({reason:"Only EIP-155 supported"});if(!i)throw new A({reason:"Chain ID not found"});if(!u)throw new A({reason:"Contract address not found"});if(!a)throw new A({reason:"Token ID not found"});if(!c)throw new A({reason:"ERC namespace not found"});return{chainID:parseInt(i),namespace:c.toLowerCase(),contractAddress:u,tokenID:a}}async function se(e,{nft:r}){if(r.namespace==="erc721")return p(e,{address:r.contractAddress,abi:[{name:"tokenURI",type:"function",stateMutability:"view",inputs:[{name:"tokenId",type:"uint256"}],outputs:[{name:"",type:"string"}]}],functionName:"tokenURI",args:[BigInt(r.tokenID)]});if(r.namespace==="erc1155")return p(e,{address:r.contractAddress,abi:[{name:"uri",type:"function",stateMutability:"view",inputs:[{name:"_id",type:"uint256"}],outputs:[{name:"",type:"string"}]}],functionName:"uri",args:[BigInt(r.tokenID)]});throw new _({namespace:r.namespace})}async function ie(e,{gatewayUrls:r,record:t}){return/eip155:/i.test(t)?me(e,{gatewayUrls:r,record:t}):B({uri:t,gatewayUrls:r})}async function me(e,{gatewayUrls:r,record:t}){let n=ae(t),a=await se(e,{nft:n}),{uri:o,isOnChain:i,isEncoded:c}=P({uri:a,gatewayUrls:r});if(i&&(o.includes("data:application/json;base64,")||o.startsWith("{"))){let l=c?atob(o.replace("data:application/json;base64,","")):o,h=JSON.parse(l);return B({uri:M(h),gatewayUrls:r})}let u=n.tokenID;return n.namespace==="erc1155"&&(u=u.replace("0x","").padStart(64,"0")),oe({gatewayUrls:r,uri:o.replace(/(?:0x)?{id}/,u)})}async function Tr(e,{blockNumber:r,blockTag:t,gatewayUrls:n,name:a,universalResolverAddress:o}){let i=await d(e,te,"getEnsText")({blockNumber:r,blockTag:t,key:"avatar",name:a,universalResolverAddress:o});if(!i)return null;try{return await ie(e,{record:i,gatewayUrls:n})}catch{return null}}s();async function Pr(e,{address:r,blockNumber:t,blockTag:n,universalResolverAddress:a}){let o=a;if(!o){if(!e.chain)throw new Error("client chain not configured. universalResolverAddress is required.");o=b({blockNumber:t,chain:e.chain,contract:"ensUniversalResolver"})}let i=`${r.toLowerCase().substring(2)}.addr.reverse`;try{return(await d(e,p,"readContract")({address:o,abi:X,functionName:"reverse",args:[g(y(i))],blockNumber:t,blockTag:n}))[0]}catch(c){if(C(c,"reverse"))return null;throw c}}s();async function Jr(e,{blockNumber:r,blockTag:t,name:n,universalResolverAddress:a}){let o=a;if(!o){if(!e.chain)throw new Error("client chain not configured. universalResolverAddress is required.");o=b({blockNumber:r,chain:e.chain,contract:"ensUniversalResolver"})}let[i]=await d(e,p,"readContract")({address:o,abi:[{inputs:[{type:"bytes"}],name:"findResolver",outputs:[{type:"address"},{type:"bytes32"}],stateMutability:"view",type:"function"}],functionName:"findResolver",args:[g(y(n))],blockNumber:r,blockTag:t});return i}export{d as a,re as b,p as c,R as d,Y as e,sr as f,te as g,Tr as h,Pr as i,Jr as j};
